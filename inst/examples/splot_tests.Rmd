---
title: "splot() Test Networks"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=7, fig.height=7)
if ("Sonnet" %in% loadedNamespaces()) detach("package:Sonnet", unload = TRUE)
devtools::install("../../", quiet = TRUE)
library(Sonnet)
```

## Test 1: Basic 8-node network

```{r test1}
set.seed(42)
mat1 <- matrix(sample(c(0, 0.3, 0.5, 0.8, 1), 64, replace = TRUE,
                      prob = c(0.6, 0.1, 0.1, 0.1, 0.1)), 8, 8)
diag(mat1) <- 0
rownames(mat1) <- colnames(mat1) <- LETTERS[1:8]
splot(mat1, layout = "spring", curve = 0.15)
```

## Test 2: 10-node with shapes

```{r test2}
mat2 <- matrix(0, 10, 10)
mat2[1, 2:4] <- c(0.8, 0.6, 0.4)
mat2[2, c(3, 5, 6)] <- c(0.7, 0.5, 0.3)
mat2[3, c(4, 7)] <- c(0.9, 0.6)
mat2[4, c(5, 8)] <- c(0.4, 0.7)
mat2[5, c(6, 9)] <- c(0.8, 0.5)
mat2[6, c(7, 10)] <- c(0.6, 0.4)
mat2[7, 8] <- 0.7
mat2[8, 9] <- 0.5
mat2[9, 10] <- 0.8
mat2[10, 1] <- 0.6
rownames(mat2) <- colnames(mat2) <- paste0("N", 1:10)
splot(mat2, shape = c("circle", "square", "triangle", "diamond", "pentagon",
                      "hexagon", "star", "heart", "ellipse", "cross"),
      color = rainbow(10), curve = 0.2)
```

## Test 3: 12-node weighted network

```{r test3}
set.seed(123)
mat3 <- matrix(rnorm(144, 0, 0.4), 12, 12)
mat3[abs(mat3) < 0.3] <- 0
diag(mat3) <- 0
rownames(mat3) <- colnames(mat3) <- month.abb
splot(mat3, layout = "spring", posCol = "darkgreen", negCol = "darkred",
      curve = 0.15, minimum = 0.1)
```

## Test 4: 9-node with self-loops

```{r test4}
mat4 <- matrix(c(
  0.5, 0.8, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0,
  0.0, 0.6, 0.7, 0.0, 0.4, 0.0, 0.0, 0.0, 0.0,
  0.0, 0.0, 0.4, 0.5, 0.0, 0.6, 0.0, 0.0, 0.0,
  0.0, 0.0, 0.0, 0.7, 0.8, 0.0, 0.3, 0.0, 0.0,
  0.0, 0.0, 0.0, 0.0, 0.5, 0.9, 0.0, 0.4, 0.0,
  0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 0.7, 0.0, 0.5,
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 0.6, 0.0,
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4, 0.7,
  0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5
), 9, 9, byrow = TRUE)
rownames(mat4) <- colnames(mat4) <- paste0("V", 1:9)
splot(mat4, layout = "circle", curve = 0.2, color = "#4A90D9")
```

## Test 5: 7-node pie chart nodes

```{r test5}
mat5 <- matrix(c(
  0, 1, 1, 0, 0, 0, 1,
  0, 0, 1, 1, 0, 0, 0,
  0, 0, 0, 1, 1, 0, 0,
  0, 0, 0, 0, 1, 1, 0,
  0, 0, 0, 0, 0, 1, 1,
  1, 0, 0, 0, 0, 0, 1,
  0, 1, 0, 0, 0, 0, 0
), 7, 7, byrow = TRUE)
rownames(mat5) <- colnames(mat5) <- c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
pie_data <- list(
  c(3, 2, 1), c(2, 3), c(1, 1, 1, 1), c(4, 1),
  c(2, 2, 2), c(1, 5), c(3, 3)
)
splot(mat5, pie = pie_data, layout = "circle", curve = 0.1)
```

## Test 6: 11-node donut nodes

```{r test6}
set.seed(456)
mat6 <- matrix(sample(c(0, 1), 121, replace = TRUE, prob = c(0.7, 0.3)), 11, 11)
diag(mat6) <- 0
rownames(mat6) <- colnames(mat6) <- paste0("D", 1:11)
donut_vals <- as.list(runif(11, 0.2, 0.9))
splot(mat6, donut = donut_vals, layout = "spring", curve = 0.15,
      donutColor = as.list(rep("#E74C3C", 11)))
```

## Test 7: 15-node complex network

```{r test7}
set.seed(789)
mat7 <- matrix(0, 15, 15)
for (i in 1:15) {
  targets <- sample(setdiff(1:15, i), sample(2:4, 1))
  mat7[i, targets] <- runif(length(targets), 0.3, 1)
}
rownames(mat7) <- colnames(mat7) <- paste0("X", 1:15)
splot(mat7, layout = "spring", curve = 0.2,
      color = colorRampPalette(c("#3498DB", "#9B59B6", "#E74C3C"))(15),
      vsize = runif(15, 0.03, 0.06))
```

## Test 8: 8-node bidirectional edges

```{r test8}
mat8 <- matrix(c(
  0, 0.7, 0, 0, 0.5, 0, 0, 0.3,
  0.6, 0, 0.8, 0, 0, 0.4, 0, 0,
  0, 0.5, 0, 0.7, 0, 0, 0.6, 0,
  0, 0, 0.8, 0, 0.9, 0, 0, 0.5,
  0.4, 0, 0, 0.6, 0, 0.7, 0, 0,
  0, 0.3, 0, 0, 0.8, 0, 0.9, 0,
  0, 0, 0.7, 0, 0, 0.5, 0, 0.8,
  0.6, 0, 0, 0.4, 0, 0, 0.7, 0
), 8, 8, byrow = TRUE)
rownames(mat8) <- colnames(mat8) <- LETTERS[1:8]
splot(mat8, layout = "circle", curve = 0.25, bidirectional = TRUE)
```

## Test 9: 13-node with group coloring

```{r test9}
set.seed(101)
mat9 <- matrix(0, 13, 13)
grp <- c(1,1,1,1, 2,2,2,2, 3,3,3,3,3)
for (i in 1:13) {
  same_grp <- which(grp == grp[i] & (1:13) != i)
  diff_grp <- which(grp != grp[i])
  if (length(same_grp) > 0) mat9[i, sample(same_grp, min(2, length(same_grp)))] <- runif(min(2, length(same_grp)), 0.6, 1)
  if (length(diff_grp) > 0) mat9[i, sample(diff_grp, 1)] <- runif(1, 0.2, 0.5)
}
rownames(mat9) <- colnames(mat9) <- paste0("G", 1:13)
splot(mat9, layout = "spring", curve = 0.15,
      color = c("#E74C3C", "#3498DB", "#2ECC71")[grp])
```

## Test 10: 10-node mixed pie and donut

```{r test10}
mat10 <- matrix(c(
  0, 0.8, 0.6, 0, 0, 0.4, 0, 0, 0, 0.3,
  0, 0, 0.7, 0.5, 0, 0, 0.3, 0, 0, 0,
  0, 0, 0, 0.8, 0.4, 0, 0, 0.6, 0, 0,
  0, 0, 0, 0, 0.9, 0.3, 0, 0, 0.5, 0,
  0.5, 0, 0, 0, 0, 0.7, 0.4, 0, 0, 0.6,
  0, 0.6, 0, 0, 0, 0, 0.8, 0.3, 0, 0,
  0, 0, 0.4, 0, 0, 0, 0, 0.9, 0.5, 0,
  0, 0, 0, 0.7, 0, 0, 0, 0, 0.6, 0.4,
  0.3, 0, 0, 0, 0.5, 0, 0, 0, 0, 0.8,
  0, 0.4, 0, 0, 0, 0.6, 0, 0, 0, 0
), 10, 10, byrow = TRUE)
rownames(mat10) <- colnames(mat10) <- paste0("M", 1:10)
pie_mix <- list(c(2,3,1), NULL, c(1,1,1,1), NULL, c(3,2),
                NULL, c(1,2,3,4), NULL, c(2,2), NULL)
donut_mix <- list(NULL, 0.7, NULL, 0.4, NULL, 0.8, NULL, 0.5, NULL, 0.6)
splot(mat10, pie = pie_mix, donut = donut_mix, layout = "spring", curve = 0.2)
```
